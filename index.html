<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" media="all" href="style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">
    <!-- MDBootstrap Datatables  -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">


    <!-- TITLE -->
    <title>Binary 64 Floating Point Converter</title>
</head>

<body>
<nav class="navbar navbar-expand-lg sticky-top navbar-dark">
    <a class="navbar-brand" href="/">CSARCH2 - Group 3</a>
   
</nav>

<h1> Binary 64 Floating Point Converter </h1>


<form class="main" id="form">
    <div class="container">
        <div class="content">
            <form>
                <div class="form-group">
                    <label for="input">Input</label>
                    <input type="text" class="form-control" id="inputAns" placeholder="Enter binary 64">
                </div>
                <div class="form-group">
                    <label for="binary">Base-2 Exponent</label>
                    <input type="text" class="form-control" id="significand" placeholder="Enter base-2 exponent">
                </div>
                <button type="button" class="btn btn-primary" onclick="convert()">Submit</button>
            </form>
        </div>
    </div>
</form>

<form class="main" id="form">
    <div class="container">
            <fieldset disabled>
                <form>
                    <div class="form-row">
                        <div class="form-group col-md-2">
                            <label for="sign">Sign</label>
                            <input type="text" class="form-control" id="sign">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="exponent">Exponent Representation</label>
                            <input type="text" class="form-control" id="exponent">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="fraction">Fraction Part of Significand</label>
                            <input type="text" class="form-control" id="fraction">
                        </div>
                    </div>
                </form>

                <form>
                    <div class="form-group row">
                      <label for="hex" class="col-sm-2 col-form-label">Hexadecimal</label>
                      <div class="col-sm-10">
                        <input type="text" class="form-control" id="hex" >
                      </div>
                    </div>
                </form>
            </fieldset>
    </div>
</form>


<script>
    function convert(){
        var input = parseFloat($('#inputAns').val());
        var exponent = parseInt($('#significand').val()) + 1023;
        // console.log(input)
        // console.log(exponent)
        // sign bit
        var sign = (''+input)[0];
        // console.log(sign)
        if(sign == '-'){
            $('#sign').val(1);
        }
        else{
            $('#sign').val(0);
        }

        // exponent representation bits
        var input_exponent = $('#significand').val()
        if(input_exponent >= -1022 && input_exponent <= 1023){
            var binary_exponent = (exponent >>> 0).toString(2);
            $('#exponent').val(binary_exponent);

            var binary_exponent_length = binary_exponent.length;
            // console.log(binary_exponent_length);
            if(binary_exponent_length < 11){
                $('#exponent').val('0' + binary_exponent);
            }

            var post_bin = $('#exponent').val();
            // console.log(post_bin.length)
            // var post_bin_length = post_bin.length;

            // for (let i = 0; i < post_bin_length; i++){
            //     if(i == 3 || i == 7){
            //         $('#exponent').push("_");
            //     }
            //     $('#exponent').append(post_bin[i])
            // }

            if(sign == '-'){
                n = 3
            }
            else{
                n = 2
            }
            var input_val = $('#inputAns').val()
            // console.log(input_length)
            // console.log(input.length)
            var input_length = input_val.length
            // for (i = n; i < input_length.length; i++){
                $('#fraction').val(input_val.slice(n,input_length))
                // fraction_array.push(input_length[i]);
            // }

            var fraction_val = $('#fraction').val()
            var fraction_length = fraction_val.length;

            var needed = 52 - fraction_length

            var needed_zeroes = "";
            var zeroes = "0";
            for (let i = 0; i < needed; i++){
                needed_zeroes = needed_zeroes.concat(zeroes);
            }
            // console.log(needed_zeroes.length)
            var fraction_final = fraction_val.concat(needed_zeroes)
            $('#fraction').val(fraction_final)
        }
        
        // hex representation
        var sign = $('#sign').val();
        var exponent = $('#exponent').val();
        var fraction = $('#fraction').val();
        var hex = sign.concat(exponent, fraction);

        var hex_final = ""
        var first = 0;
        var second = 4;
        for (let i=0; i<15; i++){
            var to_be_concat = convert_hex(hex.slice(first,second));
            hex_final = hex_final.concat(to_be_concat);
            first = second;
            second = second + 4;
        }
        // console.log(hex)
        // console.log(hex.slice(0,4))
        // console.log(hex.slice(4,8))
        // console.log(hex.slice(8,12))
        // console.log(hex.slice(12,16))
        // console.log(hex.slice(16,20))

        $('#hex').val('0x' + hex_final);
    }

    function convert_hex(strings){
        if(strings == "0000"){
            return "0";
        }
        else if (strings == "0001"){
            return "1";
        }
        else if (strings == "0010"){
            return "2";
        }
        else if (strings == "0011"){
            return "3";
        }
        else if (strings == "0100"){
            return "4";
        }
        else if (strings == "0101"){
            return "5";
        }
        else if (strings == "0110"){
            return "6";
        }
        else if (strings == "0111"){
            return "7";
        }
        else if (strings == "1000"){
            return "8";
        }
        else if (strings == "1001"){
            return "9";
        }
        else if (strings == "1010"){
            return "A";
        }
        else if (strings == "1011"){
            return "B";
        }
        else if (strings == "1100"){
            return "C";
        }
        else if (strings == "1101"){
            return "D";
        }
        else if (strings == "1110"){
            return "E";
        }
        else if (strings == "1111"){
            return "F";
        }
    }
</script>


</body>
</html>